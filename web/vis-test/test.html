<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="./vis-network.css">
    <link rel="stylesheet" href="./test.css">
    <script src="./vis-network.js"></script>
    <title>vis-test</title>
</head>
<body>
    <div id="knowledge-graph">

    </div>

    <script type="text/javascript">
        // create an array with nodes
        var nodes = new vis.DataSet([
            {id: 1, label: 'Node 1'},
            {id: 2, label: 'Node 2'},
            {id: 3, label: 'Node 3'},
            {id: 4, label: 'Node 4'},
            {id: 5, label: 'Node 5'}
        ]);
    
        // create an array with edges
        var edges = new vis.DataSet([
            {from: 1, to: 3},
            {from: 1, to: 2},
            {from: 2, to: 4},
            {from: 2, to: 5}
        ]);

        // create a network
        var container = document.getElementById('knowledge-graph');
    
        // provide the data in the vis format
        var data = {
            nodes: nodes,
            edges: edges
        };
        var options = {
            autoResize : false,                     //开始时是否静止 false是静止
            layout:{randomSeed:13},                  //3,13,15,16,18,21
            physics : {
                barnesHut:{
                    gravitationalConstant:-1600,    //排斥力：负的越多，排斥力越大
                    damping:0.9,                    //迭代速度：0~1 越大速度越慢
                    avoidOverlap:1               //避免重叠：0~1 大不重叠    效果不明显
                },
                maxVelocity:5,
                stabilization:{
                    enabled: false,
                    iterations:2000,
                    onlyDynamicEdges:true
                }
            }
        }
    
        // initialize your network!
        var network = new vis.Network(container, data, options);

        var addNode = function(id,label,toId){
            let newNode = {id: id, label: label};
            let line = {from : toId, to: id};
            nodes.add(newNode);
            edges.add(line);
        }

        var viewNode = function(id,label,toId){
            let newNode = {id: id, label: label};
            nodes.add(newNode);
        }

        var deleteNode = function(id,label,toId){
            let newNode = {id: id, label: label};
            nodes.remove(newNode);
        }

        //node 3 的附属节点
        addNode(6, "Node 6", 3);
        addNode(7, "Node 7", 3);
        deleteNode(7, "Node 7", 3);
        deleteNode(6, "Node 6", 3);

        //node 1 的附属节点
        addNode(8,"Node 8",1);
        deleteNode(8,"Node 8",1);

        //node 4 的附属节点
        addNode(9,"Node 9",4);
        deleteNode(9,"Node 9",4);
        addNode(10,"Node 10",4);
        deleteNode(10,"Node 10",4);

        network.on('click',(e) => {
            if(e.nodes[0] == 3){
                if(e.edges.length == 1){
                    viewNode(6, "Node 6", 3);
                    viewNode(7, "Node 7", 3);
                    deleteNode(5, "Node 5", 2);
                    deleteNode(4, "Node 4", 2);
                    deleteNode(2, "Node 2", 1);
                }
                else if(e.edges.length == 3){
                    //删除添加的两个节点
                    deleteNode(7, "Node 7", 3);
                    deleteNode(6, "Node 6", 3);
                    viewNode(2, "Node 2", 1);
                    viewNode(4, "Node 4", 2);
                    viewNode(5, "Node 5", 2);
                }
            }
            if(e.nodes[0] == 1){
                if(e.edges.length == 2){
                    deleteNode(5, "Node 5", 2);
                    deleteNode(4, "Node 4", 2);
                    viewNode(8,"Node 8",1);
                }
                else if(e.edges.length == 3){
                    viewNode(5, "Node 5", 2);
                    viewNode(4, "Node 4", 2);
                    deleteNode(8,"Node 8",1);
                }
            }
            if(e.nodes[0] == 4){
                if(e.edges.length == 1){
                    deleteNode(3,"Node 3",1);
                    deleteNode(1,"Node 1",2);
                    deleteNode(5,"Node 5",2);
                    viewNode(9,"Node 9",4);
                    viewNode(10,"Node 10",4);
                }
                else if(e.edges.length == 3){
                    deleteNode(10,"Node 10",4);
                    deleteNode(9,"Node 9",4);
                    viewNode(5,"Node 5",2);
                    viewNode(1,"Node 1",2);
                    viewNode(3,"Node 3",1);
                }
            }
        })
    </script>
</body>
</html>